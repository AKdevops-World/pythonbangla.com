{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="row mb-2">
{% for topic in topic_category %}
  <div class="col-md-6">
    <div class="card flex-md-row mb-4 box-shadow h-md-250">
      <div class="card-body d-flex flex-column align-items-start">
        <strong class="d-inline-block mb-2 color-gray">{{topic.title_english}}</strong>
        <h3 class="mb-0">
          <a id="id_{{topic.title_english|cut:' '}}" class="color{{ forloop.counter }}" href="#contents">{{topic.title_other}}</a>
        </h3>
        <div class="mb-2"></div>
        <p class="card-text mb-auto card-overflow">
        {{topic.short_description}}
        </p>
      </div>
      <img class="card-img-right flex-auto d-none d-lg-block" src="{% static 'img/cards/' %}{{topic.image_name}}" alt="{{topic.title_english}}">
    </div>
  </div>
{% endfor %}
</div>

<div id="contents" href="#"></div>
<ul class="nav nav-tabs" id="myTab" role="tablist">
  {% for topic in topic_category %}
  <li class="nav-item">
      <a class="nav-link {% if forloop.counter == 1 %}active{% endif %}" id="tab-{{ topic.title_english|cut:' ' }}" data-toggle="tab" href="#con-{{ topic.title_english|cut:' ' }}" role="tab" aria-controls="home"
        aria-selected="true">{{ topic.title_other }}</a>
  </li>
  {% endfor %}
</ul>

<div class="tab-content" id="myTabContent">
{% for topic in topic_category %}
  <div class="tab-pane fade {% if forloop.counter == 1 %}show active{% endif %}" id="con-{{ topic.title_english|cut:' ' }}" role="tabpanel" aria-labelledby="tab-{{ topic.title_english|cut:' ' }}">
      {% if topic.topic_type == 'YT' %}
      <!-- List & Videos Area -->
      <div class="video-border p-3 p-md-5 rounded-right rounded-bottom">
        <div role="tabpanel">
          <div class="row">
            <div class="col-4">
              <div class="list-group" id="list-tab" role="tablist">
                {% for tcontent in topic.contents %}
                <a class="list-group-item list-group-item-action {% if forloop.counter == 1 %} active show {% endif %}" id="list-home-list" data-toggle="tab" href="{{ tcontent.video_id }}" role="tab"
                  aria-controls="list-home" aria-selected="true">{{ tcontent.title }}</a>
                  <span class="d-none">{{ tcontent.description }}</span>
                {% endfor %}
              </div>
            </div>
            <!-- Youtube -->
            <div id="youtube-container" class="col-8">
              <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade active show" id="list-home" role="tabpanel" aria-labelledby="list-home-list">
                  <div class="videoWrapper">
                    <iframe id="youtube-player" type="text/html" width="560" height="315" src="https://www.youtube.com/embed/{{topic.contents.0.video_id}}" frameborder="0"
                      allowfullscreen></iframe>
                  </div>
                  <div class="mb-3"></div>
                  <div id="youtube-description">
                      <pre style="white-space: pre-wrap;">{{topic.contents.0.description}}</pre>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      {% elif topic.topic_type == 'UR' %}
      <!-- Tutorial -->
      <ul class="list-group rounded">
          <li class="list-group-item">
            <a href="http://thinkdiff.net/python/python-tutorial-for-beginners-learn-how-to-setup-python/" target="_blank">1. How to Setup Python 3 in Mac or Windows and Hello World</a>
          </li>
          <li class="list-group-item">
            <a href="http://thinkdiff.net/python/python-tutorial-for-beginner-learn-comments-variables-operators/" target="_blank">2. How to Write Comments Variable Operators</a>
          </li>
          <li class="list-group-item">
            <a href="http://thinkdiff.net/python/python-tutorial-for-beginner-statement-expression-string/" target="_blank">3. What is Statements Expression and Strings</a>
          </li>
      </ul>
      <!-- End of Tutorial -->
      {% endif %}
  </div>
{% endfor %}
</div>

{% endblock content %}

{% block script %}
<script src="{% static 'js/ba-linkify.min.js' %}"></script>
<script>
  {% for topic in topic_category %}
  $("#id_{{topic.title_english|cut:' '}}").on('click', function (e) {
      $("#tab-{{topic.title_english|cut:' '}}").tab('show')
  })
  {% endfor %}

  $('#myTabContent #list-tab a').each(function (index) {
      $(this).on('click', function (e) {
          var href = $(this).attr('href')
          var newUrl = "https://www.youtube.com/embed/" + href
          $('#youtube-container iframe').attr('src', newUrl)

          var videoDesc = $(this).next().text()
          videoDesc = linkify(videoDesc)
          $('#youtube-description pre').html(videoDesc)
      })
  })

</script>
{% endblock script %}